/*! @preserve a11y-dialog 7.3.0 — © Kitty Giraudel */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).A11yDialog=t()}(this,function(){"use strict";var s=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'];function t(e){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this.$el=e,this.shown=!1,this._id=this.$el.getAttribute("data-a11y-dialog")||this.$el.id,this._previouslyFocused=null,this._listeners={},this.create()}function a(e,t){return e=(t||document).querySelectorAll(e),Array.prototype.slice.call(e)}function i(e){(e.querySelector("[autofocus]")||e).focus()}function e(){a("[data-a11y-dialog]").forEach(function(e){new t(e)})}return t.prototype.create=function(){return this.$el.setAttribute("aria-hidden",!0),this.$el.setAttribute("aria-modal",!0),this.$el.setAttribute("tabindex",-1),this.$el.hasAttribute("role")||this.$el.setAttribute("role","dialog"),this._openers=a('[data-a11y-dialog-show="'+this._id+'"]'),this._openers.forEach(function(e){e.addEventListener("click",this._show)}.bind(this)),this._closers=a("[data-a11y-dialog-hide]",this.$el).concat(a('[data-a11y-dialog-hide="'+this._id+'"]')),this._closers.forEach(function(e){e.addEventListener("click",this._hide)}.bind(this)),this._fire("create"),this},t.prototype.show=function(e){return this.shown||(this._previouslyFocused=document.activeElement,this.$el.removeAttribute("aria-hidden"),this.shown=!0,i(this.$el),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",e)),this},t.prototype.hide=function(e){return this.shown&&(this.shown=!1,this.$el.setAttribute("aria-hidden","true"),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",e)),this},t.prototype.destroy=function(){return this.hide(),this._openers.forEach(function(e){e.removeEventListener("click",this._show)}.bind(this)),this._closers.forEach(function(e){e.removeEventListener("click",this._hide)}.bind(this)),this._fire("destroy"),this._listeners={},this},t.prototype.on=function(e,t){return void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t),this},t.prototype.off=function(e,t){t=(this._listeners[e]||[]).indexOf(t);return-1<t&&this._listeners[e].splice(t,1),this},t.prototype._fire=function(e,t){var i=this._listeners[e]||[],e=new CustomEvent(e,{detail:t});this.$el.dispatchEvent(e),i.forEach(function(e){e(this.$el,t)}.bind(this))},t.prototype._bindKeypress=function(e){var t,i;this.$el.contains(document.activeElement)&&(this.shown&&27===e.which&&"alertdialog"!==this.$el.getAttribute("role")&&(e.preventDefault(),this.hide(e)),this.shown&&9===e.which&&(t=this.$el,i=e,e=t,t=a(s.join(","),e).filter(function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}),e=t.indexOf(document.activeElement),i.shiftKey&&0===e?(t[t.length-1].focus(),i.preventDefault()):i.shiftKey||e!==t.length-1||(t[0].focus(),i.preventDefault())))},t.prototype._maintainFocus=function(e){!this.shown||e.target.closest('[aria-modal="true"]')||e.target.closest("[data-a11y-dialog-ignore-focus-trap]")||i(this.$el)},"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout(e,16)),t}),function(){"use strict";function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e){return e[e.length-1]}function E(t,...e){return e.forEach(e=>{t.includes(e)||t.push(e)}),t}function d(e,t){return e?e.split(t):[]}function c(e,t,i){return(void 0===t||t<=e)&&(void 0===i||e<=i)}function l(e,t,i){return e<t?t:i<e?i:e}function r(e,t,s={},a=0,i=""){i+=`<${Object.keys(s).reduce((e,t)=>{let i=s[t];return"function"==typeof i&&(i=i(a)),`${e} ${t}="${i}"`},e)}></${e}>`;var n=a+1;return n<t?r(e,t,s,n,i):i}function e(e){return e.replace(/>\s+/g,">").replace(/\s+</,"<")}function a(e){return new Date(e).setHours(0,0,0,0)}function m(){return(new Date).setHours(0,0,0,0)}function w(...e){switch(e.length){case 0:return m();case 1:return a(e[0])}const t=new Date(0);return t.setFullYear(...e),t.setHours(0,0,0,0)}function u(e,t){const i=new Date(e);return i.setDate(i.getDate()+t)}function h(e,t){const i=new Date(e),s=i.getMonth()+t;let a=s%12;a<0&&(a+=12);t=i.setMonth(s);return i.getMonth()!==a?i.setDate(0):t}function f(e,t){const i=new Date(e),s=i.getMonth(),a=i.setFullYear(i.getFullYear()+t);return 1===s&&2===i.getMonth()?i.setDate(0):a}function n(e,t){return(e-t+7)%7}function p(e,t,i=0){var s=new Date(e).getDay();return u(e,n(t,i)-n(s,i))}function b(e,t){e=new Date(e).getFullYear();return Math.floor(e/t)*t}function L(e,t,i){if(1!==t&&2!==t)return e;const s=new Date(e);return 1===t?i?s.setMonth(s.getMonth()+1,0):s.setDate(1):i?s.setFullYear(s.getFullYear()+1,0,0):s.setMonth(0,1),s.setHours(0,0,0,0)}const D=/dd?|DD?|mm?|MM?|yy?(?:yy)?/,v=/[\s!-/:-@[-`{-~年月日]+/;let i={};const g={y:(e,t)=>new Date(e).setFullYear(parseInt(t,10)),m(t,e,i){const s=new Date(t);let a=parseInt(e,10)-1;if(isNaN(a)){if(!e)return NaN;const t=e.toLowerCase(),s=e=>e.toLowerCase().startsWith(t);if(a=i.monthsShort.findIndex(s),a<0&&(a=i.months.findIndex(s)),a<0)return NaN}return s.setMonth(a),s.getMonth()!==function e(t){return-1<t?t%12:e(t+12)}(a)?s.setDate(0):s.getTime()},d:(e,t)=>new Date(e).setDate(parseInt(t,10))},s={d:e=>e.getDate(),dd:e=>t(e.getDate(),2),D:(e,t)=>t.daysShort[e.getDay()],DD:(e,t)=>t.days[e.getDay()],m:e=>e.getMonth()+1,mm:e=>t(e.getMonth()+1,2),M:(e,t)=>t.monthsShort[e.getMonth()],MM:(e,t)=>t.months[e.getMonth()],y:e=>e.getFullYear(),yy:e=>t(e.getFullYear(),2).slice(-2),yyyy:e=>t(e.getFullYear(),4)};function t(e,t){return e.toString().padStart(t,"0")}function y(e){if("string"!=typeof e)throw new Error("Invalid date format.");if(e in i)return i[e];const n=e.split(D),a=e.match(new RegExp(D,"g"));if(0===n.length||!a)throw new Error("Invalid date format.");const t=a.map(e=>s[e]),r=Object.keys(g).reduce((e,t)=>(a.find(e=>"D"!==e[0]&&e[0].toLowerCase()===t)&&e.push(t),e),[]);return i[e]={parser(e,i){const s=e.split(v).reduce((e,t,i)=>{return 0<t.length&&a[i]&&("M"===(i=a[i][0])?e.m=t:"D"!==i&&(e[i]=t)),e},{});return r.reduce((e,t)=>{t=g[t](e,s[t],i);return isNaN(t)?e:t},m())},formatter:(s,a)=>t.reduce((e,t,i)=>e+`${n[i]}${t(s,a)}`,"")+o(n)}}function k(e,t,i){if(e instanceof Date||"number"==typeof e){const t=a(e);return isNaN(t)?void 0:t}if(e){if("today"===e)return m();if(t&&t.toValue){var s=t.toValue(e,t,i);return isNaN(s)?void 0:a(s)}return y(t).parser(e,i)}}function S(e,t,i){if(isNaN(e)||!e&&0!==e)return"";e="number"==typeof e?new Date(e):e;return t.toDisplay?t.toDisplay(e,t,i):y(t).formatter(e,i)}const x=document.createRange();function A(e){return x.createContextualFragment(e)}function M(e){return e.parentElement||(e.parentNode instanceof ShadowRoot?e.parentNode.host:void 0)}function O(e){return e.getRootNode().activeElement===e}function T(e){"none"!==e.style.display&&(e.style.display&&(e.dataset.styleDisplay=e.style.display),e.style.display="none")}function C(e){"none"===e.style.display&&(e.dataset.styleDisplay?(e.style.display=e.dataset.styleDisplay,delete e.dataset.styleDisplay):e.style.display="")}function N(e){e.firstChild&&(e.removeChild(e.firstChild),N(e))}const I=new WeakMap,{addEventListener:B,removeEventListener:F}=EventTarget.prototype;function R(e,t){let i=I.get(e);i||(i=[],I.set(e,i)),t.forEach(e=>{B.call(...e),i.push(e)})}function V(e){let t=I.get(e);t&&(t.forEach(e=>{F.call(...e)}),I.delete(e))}if(!Event.prototype.composedPath){const _=(e,t=[])=>{let i;return t.push(e),e.parentNode?i=e.parentNode:e.host?i=e.host:e.defaultView&&(i=e.defaultView),i?_(i,t):t};Event.prototype.composedPath=function(){return _(this.target)}}function P(e,t){var i="function"==typeof t?t:e=>e instanceof Element&&e.matches(t);return function e(t,i,s){var[a,...t]=t;return i(a)?a:a!==s&&"HTML"!==a.tagName&&0!==t.length?e(t,i,s):void 0}(e.composedPath(),i,e.currentTarget)}const H={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM y"}},q={autohide:!1,beforeShowDay:null,beforeShowDecade:null,beforeShowMonth:null,beforeShowYear:null,calendarWeeks:!1,clearBtn:!1,dateDelimiter:",",datesDisabled:[],daysOfWeekDisabled:[],daysOfWeekHighlighted:[],defaultViewDate:void 0,disableTouchKeyboard:!1,format:"mm/dd/yyyy",language:"en",maxDate:null,maxNumberOfDates:1,maxView:3,minDate:null,nextArrow:"»",orientation:"auto",pickLevel:0,prevArrow:"«",showDaysOfWeek:!0,showOnClick:!0,showOnFocus:!0,startView:0,title:"",todayBtn:!1,todayBtnMode:0,todayHighlight:!1,updateOnBlur:!0,weekStart:0},{language:Y,format:W,weekStart:$}=q;function J(e,t){return e.length<6&&0<=t&&t<7?E(e,t):e}function K(e){return(e+6)%7}function U(e,t,i,s){i=k(e,t,i);return void 0!==i?i:s}function j(e,t,i=3){e=parseInt(e,10);return 0<=e&&e<=i?e:t}function G(t,e){const i=Object.assign({},t),s={},a=e.constructor.locales,n=e.rangeSideIndex;let{format:r,language:o,locale:l,maxDate:d,maxView:c,minDate:u,pickLevel:h,startView:f,weekStart:p}=e.config||{};if(i.language){let e;if(i.language!==o&&(a[i.language]?e=i.language:(e=i.language.split("-")[0],void 0===a[e]&&(e=!1))),delete i.language,e){o=s.language=e;const t=l||a[Y];l=Object.assign({format:W,weekStart:$},a[Y]),o!==Y&&Object.assign(l,a[o]),s.locale=l,r===t.format&&(r=s.format=l.format),p===t.weekStart&&(p=s.weekStart=l.weekStart,s.weekEnd=K(l.weekStart))}}if(i.format){const _="function"==typeof i.format.toDisplay,t="function"==typeof i.format.toValue,E=D.test(i.format);(_&&t||E)&&(r=s.format=i.format),delete i.format}let m=h;void 0!==i.pickLevel&&(m=j(i.pickLevel,2),delete i.pickLevel),m!==h&&(m>h&&(void 0===i.minDate&&(i.minDate=u),void 0===i.maxDate&&(i.maxDate=d)),i.datesDisabled||(i.datesDisabled=[]),h=s.pickLevel=m);let b=u,v=d;if(void 0!==i.minDate){const _=w(0,0,1);b=null===i.minDate?_:U(i.minDate,r,l,b),b!==_&&(b=L(b,h,!1)),delete i.minDate}if(void 0!==i.maxDate&&(v=null===i.maxDate?void 0:U(i.maxDate,r,l,v),void 0!==v&&(v=L(v,h,!0)),delete i.maxDate),v<b?(u=s.minDate=v,d=s.maxDate=b):(u!==b&&(u=s.minDate=b),d!==v&&(d=s.maxDate=v)),i.datesDisabled&&(s.datesDisabled=i.datesDisabled.reduce((e,t)=>{t=k(t,r,l);return void 0!==t?E(e,L(t,h,n)):e},[]),delete i.datesDisabled),void 0!==i.defaultViewDate){const _=k(i.defaultViewDate,r,l);void 0!==_&&(s.defaultViewDate=_),delete i.defaultViewDate}if(void 0!==i.weekStart){const _=Number(i.weekStart)%7;isNaN(_)||(p=s.weekStart=_,s.weekEnd=K(_)),delete i.weekStart}if(i.daysOfWeekDisabled&&(s.daysOfWeekDisabled=i.daysOfWeekDisabled.reduce(J,[]),delete i.daysOfWeekDisabled),i.daysOfWeekHighlighted&&(s.daysOfWeekHighlighted=i.daysOfWeekHighlighted.reduce(J,[]),delete i.daysOfWeekHighlighted),void 0!==i.maxNumberOfDates){const _=parseInt(i.maxNumberOfDates,10);0<=_&&(s.maxNumberOfDates=_,s.multidate=1!==_),delete i.maxNumberOfDates}i.dateDelimiter&&(s.dateDelimiter=String(i.dateDelimiter),delete i.dateDelimiter);let g=c;void 0!==i.maxView&&(g=j(i.maxView,c),delete i.maxView),g=h>g?h:g,g!==c&&(c=s.maxView=g);let y=f;if(void 0!==i.startView&&(y=j(i.startView,y),delete i.startView),y<h?y=h:y>c&&(y=c),y!==f&&(s.startView=y),i.prevArrow){const _=A(i.prevArrow);0<_.childNodes.length&&(s.prevArrow=_.childNodes),delete i.prevArrow}if(i.nextArrow){const _=A(i.nextArrow);0<_.childNodes.length&&(s.nextArrow=_.childNodes),delete i.nextArrow}if(void 0!==i.disableTouchKeyboard&&(s.disableTouchKeyboard="ontouchstart"in document&&!!i.disableTouchKeyboard,delete i.disableTouchKeyboard),i.orientation){const _=i.orientation.toLowerCase().split(/\s+/g);s.orientation={x:_.find(e=>"left"===e||"right"===e)||"auto",y:_.find(e=>"top"===e||"bottom"===e)||"auto"},delete i.orientation}if(void 0!==i.todayBtnMode){switch(i.todayBtnMode){case 0:case 1:s.todayBtnMode=i.todayBtnMode}delete i.todayBtnMode}return Object.keys(i).forEach(e=>{void 0!==i[e]&&_(q,e)&&(s[e]=i[e])}),s}const z=e('<div class="datepicker">\n  <div class="datepicker-picker">\n    <div class="datepicker-header">\n      <div class="datepicker-title"></div>\n      <div class="datepicker-controls">\n        <button type="button" class="%buttonClass% prev-btn"></button>\n        <button type="button" class="%buttonClass% view-switch"></button>\n        <button type="button" class="%buttonClass% next-btn"></button>\n      </div>\n    </div>\n    <div class="datepicker-main"></div>\n    <div class="datepicker-footer">\n      <div class="datepicker-controls">\n        <button type="button" class="%buttonClass% today-btn"></button>\n        <button type="button" class="%buttonClass% clear-btn"></button>\n      </div>\n    </div>\n  </div>\n</div>'),X=e(`<div class="days">\n  <div class="days-of-week">${r("span",7,{class:"dow"})}</div>\n  <div class="datepicker-grid">${r("span",42)}</div>\n</div>`),Z=e(`<div class="calendar-weeks">\n  <div class="days-of-week"><span class="dow"></span></div>\n  <div class="weeks">${r("span",6,{class:"week"})}</div>\n</div>`);class Q{constructor(e,t){Object.assign(this,t,{picker:e,element:A('<div class="datepicker-view"></div>').firstChild,selected:[]}),this.init(this.picker.datepicker.config)}init(e){void 0!==e.pickLevel&&(this.isMinView=this.id===e.pickLevel),this.setOptions(e),this.updateFocus(),this.updateSelection()}performBeforeHook(e,t,i){let s=this.beforeShow(new Date(i));switch(typeof s){case"boolean":s={enabled:s};break;case"string":s={classes:s}}if(s){if(!1===s.enabled&&(e.classList.add("disabled"),E(this.disabled,t)),s.classes){const i=s.classes.split(/\s+/);e.classList.add(...i),i.includes("disabled")&&E(this.disabled,t)}s.content&&(a=e,e=s.content,N(a),e instanceof DocumentFragment?a.appendChild(e):"string"==typeof e?a.appendChild(A(e)):"function"==typeof e.forEach&&e.forEach(e=>{a.appendChild(e)}))}var a}}class ee extends Q{constructor(e){super(e,{id:0,name:"days",cellClass:"day"})}init(e,t=!0){if(t){const e=A(X).firstChild;this.dow=e.firstChild,this.grid=e.lastChild,this.element.appendChild(e)}super.init(e)}setOptions(e){let t;if(_(e,"minDate")&&(this.minDate=e.minDate),_(e,"maxDate")&&(this.maxDate=e.maxDate),e.datesDisabled&&(this.datesDisabled=e.datesDisabled),e.daysOfWeekDisabled&&(this.daysOfWeekDisabled=e.daysOfWeekDisabled,t=!0),e.daysOfWeekHighlighted&&(this.daysOfWeekHighlighted=e.daysOfWeekHighlighted),void 0!==e.todayHighlight&&(this.todayHighlight=e.todayHighlight),void 0!==e.weekStart&&(this.weekStart=e.weekStart,this.weekEnd=e.weekEnd,t=!0),e.locale){const _=this.locale=e.locale;this.dayNames=_.daysMin,this.switchLabelFormat=_.titleFormat,t=!0}if(void 0!==e.beforeShowDay&&(this.beforeShow="function"==typeof e.beforeShowDay?e.beforeShowDay:void 0),void 0!==e.calendarWeeks)if(e.calendarWeeks&&!this.calendarWeeks){const _=A(Z).firstChild;this.calendarWeeks={element:_,dow:_.firstChild,weeks:_.lastChild},this.element.insertBefore(_,this.element.firstChild)}else this.calendarWeeks&&!e.calendarWeeks&&(this.element.removeChild(this.calendarWeeks.element),this.calendarWeeks=null);void 0!==e.showDaysOfWeek&&(e.showDaysOfWeek?(C(this.dow),this.calendarWeeks&&C(this.calendarWeeks.dow)):(T(this.dow),this.calendarWeeks&&T(this.calendarWeeks.dow))),t&&Array.from(this.dow.children).forEach((e,t)=>{t=(this.weekStart+t)%7;e.textContent=this.dayNames[t],e.className=this.daysOfWeekDisabled.includes(t)?"dow disabled":"dow"})}updateFocus(){const e=new Date(this.picker.viewDate),t=e.getFullYear(),i=e.getMonth(),s=w(t,i,1),a=p(s,this.weekStart,this.weekStart);this.first=s,this.last=w(t,i+1,0),this.start=a,this.focused=this.picker.viewDate}updateSelection(){var{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e,t&&(this.range=t.dates)}render(){this.today=this.todayHighlight?m():void 0,this.disabled=[...this.datesDisabled];const i=S(this.focused,this.switchLabelFormat,this.locale);if(this.picker.setViewSwitchLabel(i),this.picker.setPrevBtnDisabled(this.first<=this.minDate),this.picker.setNextBtnDisabled(this.last>=this.maxDate),this.calendarWeeks){const i=p(this.first,1,1);Array.from(this.calendarWeeks.weeks.children).forEach((e,t)=>{e.textContent=(e=p(u(i,7*t),4,1),t=p(new Date(e).setMonth(0,4),4,1),Math.round((e-t)/6048e5)+1)})}Array.from(this.grid.children).forEach((e,t)=>{const i=e.classList,s=u(this.start,t),a=new Date(s),n=a.getDay();if(e.className=`datepicker-cell ${this.cellClass}`,e.dataset.date=s,e.textContent=a.getDate(),s<this.first?i.add("prev"):s>this.last&&i.add("next"),this.today===s&&i.add("today"),(s<this.minDate||s>this.maxDate||this.disabled.includes(s))&&i.add("disabled"),this.daysOfWeekDisabled.includes(n)&&(i.add("disabled"),E(this.disabled,s)),this.daysOfWeekHighlighted.includes(n)&&i.add("highlighted"),this.range){const[e,t]=this.range;s>e&&s<t&&i.add("range"),s===e&&i.add("range-start"),s===t&&i.add("range-end")}this.selected.includes(s)&&i.add("selected"),s===this.focused&&i.add("focused"),this.beforeShow&&this.performBeforeHook(e,s,s)})}refresh(){const[s,a]=this.range||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(e=>{e.classList.remove("range","range-start","range-end","selected","focused")}),Array.from(this.grid.children).forEach(e=>{const t=Number(e.dataset.date),i=e.classList;t>s&&t<a&&i.add("range"),t===s&&i.add("range-start"),t===a&&i.add("range-end"),this.selected.includes(t)&&i.add("selected"),t===this.focused&&i.add("focused")})}refreshFocus(){var e=Math.round((this.focused-this.start)/864e5);this.grid.querySelectorAll(".focused").forEach(e=>{e.classList.remove("focused")}),this.grid.children[e].classList.add("focused")}}function te(e,t){if(e&&e[0]&&e[1]){var[[i,s],[a,e]]=e;return t<i||a<t?void 0:[i===t?s:-1,a===t?e:12]}}class ie extends Q{constructor(e){super(e,{id:1,name:"months",cellClass:"month"})}init(e,t=!0){t&&(this.grid=this.element,this.element.classList.add("months","datepicker-grid"),this.grid.appendChild(A(r("span",12,{"data-month":e=>e})))),super.init(e)}setOptions(e){if(e.locale&&(this.monthNames=e.locale.monthsShort),_(e,"minDate"))if(void 0===e.minDate)this.minYear=this.minMonth=this.minDate=void 0;else{const _=new Date(e.minDate);this.minYear=_.getFullYear(),this.minMonth=_.getMonth(),this.minDate=_.setDate(1)}if(_(e,"maxDate"))if(void 0===e.maxDate)this.maxYear=this.maxMonth=this.maxDate=void 0;else{const _=new Date(e.maxDate);this.maxYear=_.getFullYear(),this.maxMonth=_.getMonth(),this.maxDate=w(this.maxYear,this.maxMonth+1,0)}this.isMinView?e.datesDisabled&&(this.datesDisabled=e.datesDisabled):this.datesDisabled=[],void 0!==e.beforeShowMonth&&(this.beforeShow="function"==typeof e.beforeShowMonth?e.beforeShowMonth:void 0)}updateFocus(){const e=new Date(this.picker.viewDate);this.year=e.getFullYear(),this.focused=e.getMonth()}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce((e,t)=>{const i=new Date(t),s=i.getFullYear(),a=i.getMonth();return void 0===e[s]?e[s]=[a]:E(e[s],a),e},{}),t&&t.dates&&(this.range=t.dates.map(e=>{const t=new Date(e);return isNaN(t)?void 0:[t.getFullYear(),t.getMonth()]}))}render(){this.disabled=this.datesDisabled.reduce((e,t)=>{const i=new Date(t);return this.year===i.getFullYear()&&e.push(i.getMonth()),e},[]),this.picker.setViewSwitchLabel(this.year),this.picker.setPrevBtnDisabled(this.year<=this.minYear),this.picker.setNextBtnDisabled(this.year>=this.maxYear);const a=this.selected[this.year]||[],n=this.year<this.minYear||this.year>this.maxYear,r=this.year===this.minYear,o=this.year===this.maxYear,l=te(this.range,this.year);Array.from(this.grid.children).forEach((e,t)=>{const i=e.classList,s=w(this.year,t,1);if(e.className=`datepicker-cell ${this.cellClass}`,this.isMinView&&(e.dataset.date=s),e.textContent=this.monthNames[t],(n||r&&t<this.minMonth||o&&t>this.maxMonth||this.disabled.includes(t))&&i.add("disabled"),l){const[a,n]=l;t>a&&t<n&&i.add("range"),t===a&&i.add("range-start"),t===n&&i.add("range-end")}a.includes(t)&&i.add("selected"),t===this.focused&&i.add("focused"),this.beforeShow&&this.performBeforeHook(e,t,s)})}refresh(){const s=this.selected[this.year]||[],[a,n]=te(this.range,this.year)||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(e=>{e.classList.remove("range","range-start","range-end","selected","focused")}),Array.from(this.grid.children).forEach((e,t)=>{const i=e.classList;t>a&&t<n&&i.add("range"),t===a&&i.add("range-start"),t===n&&i.add("range-end"),s.includes(t)&&i.add("selected"),t===this.focused&&i.add("focused")})}refreshFocus(){this.grid.querySelectorAll(".focused").forEach(e=>{e.classList.remove("focused")}),this.grid.children[this.focused].classList.add("focused")}}class se extends Q{constructor(e,t){super(e,t)}init(e,t=!0){t&&(this.navStep=10*this.step,this.beforeShowOption=`beforeShow${t=this.cellClass,[...t].reduce((e,t,i)=>e+(i?t:t.toUpperCase()),"")}`,this.grid=this.element,this.element.classList.add(this.name,"datepicker-grid"),this.grid.appendChild(A(r("span",12)))),super.init(e)}setOptions(e){if(_(e,"minDate")&&(void 0===e.minDate?this.minYear=this.minDate=void 0:(this.minYear=b(e.minDate,this.step),this.minDate=w(this.minYear,0,1))),_(e,"maxDate")&&(void 0===e.maxDate?this.maxYear=this.maxDate=void 0:(this.maxYear=b(e.maxDate,this.step),this.maxDate=w(this.maxYear,11,31))),this.isMinView?e.datesDisabled&&(this.datesDisabled=e.datesDisabled):this.datesDisabled=[],void 0!==e[this.beforeShowOption]){const _=e[this.beforeShowOption];this.beforeShow="function"==typeof _?_:void 0}}updateFocus(){var e=new Date(this.picker.viewDate),t=b(e,this.navStep),i=t+9*this.step;this.first=t,this.last=i,this.start=t-this.step,this.focused=b(e,this.step)}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce((e,t)=>E(e,b(t,this.step)),[]),t&&t.dates&&(this.range=t.dates.map(e=>{if(void 0!==e)return b(e,this.step)}))}render(){this.disabled=this.datesDisabled.map(e=>new Date(e).getFullYear()),this.picker.setViewSwitchLabel(`${this.first}-${this.last}`),this.picker.setPrevBtnDisabled(this.first<=this.minYear),this.picker.setNextBtnDisabled(this.last>=this.maxYear),Array.from(this.grid.children).forEach((e,t)=>{const i=e.classList,s=this.start+t*this.step,a=w(s,0,1);if(e.className=`datepicker-cell ${this.cellClass}`,this.isMinView&&(e.dataset.date=a),e.textContent=e.dataset.year=s,0===t?i.add("prev"):11===t&&i.add("next"),(s<this.minYear||s>this.maxYear||this.disabled.includes(s))&&i.add("disabled"),this.range){const[e,t]=this.range;s>e&&s<t&&i.add("range"),s===e&&i.add("range-start"),s===t&&i.add("range-end")}this.selected.includes(s)&&i.add("selected"),s===this.focused&&i.add("focused"),this.beforeShow&&this.performBeforeHook(e,s,a)})}refresh(){const[s,a]=this.range||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(e=>{e.classList.remove("range","range-start","range-end","selected","focused")}),Array.from(this.grid.children).forEach(e=>{const t=Number(e.textContent),i=e.classList;t>s&&t<a&&i.add("range"),t===s&&i.add("range-start"),t===a&&i.add("range-end"),this.selected.includes(t)&&i.add("selected"),t===this.focused&&i.add("focused")})}refreshFocus(){var e=Math.round((this.focused-this.start)/this.step);this.grid.querySelectorAll(".focused").forEach(e=>{e.classList.remove("focused")}),this.grid.children[e].classList.add("focused")}}function ae(e,t){var i={date:e.getDate(),viewDate:new Date(e.picker.viewDate),viewId:e.picker.currentView.id,datepicker:e};e.element.dispatchEvent(new CustomEvent(t,{detail:i}))}function ne(e,t){var{minDate:i,maxDate:s}=e.config,{currentView:a,viewDate:n}=e.picker;let r;switch(a.id){case 0:r=h(n,t);break;case 1:r=f(n,t);break;default:r=f(n,t*a.navStep)}r=l(r,i,s),e.picker.changeFocus(r).render()}function re(e){var t=e.picker.currentView.id;t!==e.config.maxView&&e.picker.changeView(t+1).render()}function oe(e){e.config.updateOnBlur?e.update({revert:!0}):e.refresh("input"),e.hide()}function le(e,t){const i=P(t,".datepicker-cell");var s;i&&!i.classList.contains("disabled")&&({id:s,isMinView:t}=e.picker.currentView,t?e.setDate(Number(i.dataset.date)):function(e,t){const i=e.picker,s=new Date(i.viewDate),a=i.currentView.id,n=1===a?h(s,t-s.getMonth()):f(s,t-s.getFullYear());i.changeFocus(n).changeView(a-1).render()}(e,Number(1===s?i.dataset.month:i.dataset.year)))}function de(e){e.preventDefault()}const ce=["left","top","right","bottom"].reduce((e,t)=>(e[t]=`datepicker-orient-${t}`,e),{}),ue=e=>e&&`${e}px`;function he(e,t){if(void 0!==t.title&&(t.title?(e.controls.title.textContent=t.title,C(e.controls.title)):(e.controls.title.textContent="",T(e.controls.title))),t.prevArrow){const _=e.controls.prevBtn;N(_),t.prevArrow.forEach(e=>{_.appendChild(e.cloneNode(!0))})}if(t.nextArrow){const _=e.controls.nextBtn;N(_),t.nextArrow.forEach(e=>{_.appendChild(e.cloneNode(!0))})}if(t.locale&&(e.controls.todayBtn.textContent=t.locale.today,e.controls.clearBtn.textContent=t.locale.clear),void 0!==t.todayBtn&&(t.todayBtn?C:T)(e.controls.todayBtn),_(t,"minDate")||_(t,"maxDate")){const{minDate:_,maxDate:t}=e.datepicker.config;e.controls.todayBtn.disabled=!c(m(),_,t)}void 0!==t.clearBtn&&(t.clearBtn?C:T)(e.controls.clearBtn)}function fe(e){var{dates:t,config:e}=e;return l(0<t.length?o(t):e.defaultViewDate,e.minDate,e.maxDate)}function pe(e,t){const i=new Date(e.viewDate),s=new Date(t),{id:a,year:n,first:r,last:o}=e.currentView,l=s.getFullYear();switch(e.viewDate=t,l!==i.getFullYear()&&ae(e.datepicker,"changeYear"),s.getMonth()!==i.getMonth()&&ae(e.datepicker,"changeMonth"),a){case 0:return t<r||o<t;case 1:return l!==n;default:return l<r||o<l}}function me(e){return window.getComputedStyle(e).direction}class be{constructor(e){const t=(this.datepicker=e)["config"],i=z.replace(/%buttonClass%/g,t.buttonClass),s=this.element=A(i).firstChild,[a,n,r]=s.firstChild.children,o=a.firstElementChild,[l,d,c]=a.lastElementChild.children,[u,h]=r.firstChild.children,f={title:o,prevBtn:l,viewSwitch:d,nextBtn:c,todayBtn:u,clearBtn:h};this.main=n,this.controls=f;var p=e.inline?"inline":"dropdown";s.classList.add(`datepicker-${p}`),he(this,t),this.viewDate=fe(e),R(e,[[s,"mousedown",de],[n,"click",le.bind(null,e)],[f.viewSwitch,"click",function(e){re(e)}.bind(null,e)],[f.prevBtn,"click",function(e){ne(e,-1)}.bind(null,e)],[f.nextBtn,"click",function(e){ne(e,1)}.bind(null,e)],[f.todayBtn,"click",function(e){const t=e.picker,i=m();if(1===e.config.todayBtnMode){if(e.config.autohide)return void e.setDate(i);e.setDate(i,{render:!1}),t.update()}t.viewDate!==i&&t.changeFocus(i),t.changeView(0).render()}.bind(null,e)],[f.clearBtn,"click",function(e){e.setDate({clear:!0})}.bind(null,e)]]),this.views=[new ee(this),new ie(this),new se(this,{id:2,name:"years",cellClass:"year",step:1}),new se(this,{id:3,name:"decades",cellClass:"decade",step:10})],this.currentView=this.views[t.startView],this.currentView.render(),this.main.appendChild(this.currentView.element),t.container?t.container.appendChild(this.element):e.inputField.after(this.element)}setOptions(t){he(this,t),this.views.forEach(e=>{e.init(t,!1)}),this.currentView.render()}detach(){this.element.remove()}show(){if(!this.active){const{datepicker:t,element:i}=this;var e;t.inline?i.classList.add("active"):((e=me(t.inputField))!==me(M(i))?i.dir=e:i.dir&&i.removeAttribute("dir"),i.style.visiblity="hidden",i.classList.add("active"),this.place(),i.style.visiblity="",t.config.disableTouchKeyboard&&t.inputField.blur()),this.active=!0,ae(t,"show")}}hide(){this.active&&(this.datepicker.exitEditMode(),this.element.classList.remove("active"),this.active=!1,ae(this.datepicker,"hide"))}place(){const{classList:e,offsetParent:t,style:i}=this.element,{config:s,inputField:a}=this.datepicker,{width:n,height:r}=this.element.getBoundingClientRect(),{left:o,top:l,right:d,bottom:c,width:u,height:h}=a.getBoundingClientRect();let{x:f,y:p}=s.orientation,m=o,b=l;if(t!==document.body&&t){const e=t.getBoundingClientRect();m-=e.left-t.scrollLeft,b-=e.top-t.scrollTop}else m+=window.scrollX,b+=window.scrollY;const v=function e(t){t=M(t);if(t!==document.body&&t)return"visible"!==window.getComputedStyle(t).overflow?t:e(t)}(a);let g=0,y=0,{clientWidth:_,clientHeight:E}=document.documentElement;if(v){const e=v.getBoundingClientRect();0<e.top&&(y=e.top),0<e.left&&(g=e.left),e.right<_&&(_=e.right),e.bottom<E&&(E=e.bottom)}let w=0;"auto"===f&&(o<g?(f="left",w=g-o):o+n>_?(f="right",_<d&&(w=_-d)):f="rtl"!==me(a)||d-n<g?"left":"right"),"right"===f&&(m+=u-n),m+=w,"auto"===p&&(p=l-r>y&&c+r>E?"top":"bottom"),"top"===p?b-=r:b+=h,e.remove(...Object.values(ce)),e.add(ce[f],ce[p]),i.left=ue(m),i.top=ue(b)}setViewSwitchLabel(e){this.controls.viewSwitch.textContent=e}setPrevBtnDisabled(e){this.controls.prevBtn.disabled=e}setNextBtnDisabled(e){this.controls.nextBtn.disabled=e}changeView(e){var t=this.currentView,e=this.views[e];return e.id!==t.id&&(this.currentView=e,this._renderMethod="render",ae(this.datepicker,"changeView"),this.main.replaceChild(e.element,t.element)),this}changeFocus(e){return this._renderMethod=pe(this,e)?"render":"refreshFocus",this.views.forEach(e=>{e.updateFocus()}),this}update(){var e=fe(this.datepicker);return this._renderMethod=pe(this,e)?"render":"refresh",this.views.forEach(e=>{e.updateFocus(),e.updateSelection()}),this}render(e=!0){e=e&&this._renderMethod||"render";delete this._renderMethod,this.currentView[e]()}}function ve(e,t,i,s){const a=e.picker,n=a.currentView,r=n.step||1;let o,l,d=a.viewDate;switch(n.id){case 0:d=s?u(d,7*i):(t.ctrlKey||t.metaKey?f:u)(d,i),o=u,l=e=>n.disabled.includes(e);break;case 1:d=h(d,s?4*i:i),o=h,l=e=>{const t=new Date(e),{year:i,disabled:s}=n;return t.getFullYear()===i&&s.includes(t.getMonth())};break;default:d=f(d,i*(s?4:1)*r),o=f,l=e=>n.disabled.includes(b(e,r))}d=function e(t,i,s,a,n,r){if(c(t,n,r))return a(t)?e(i(t,s),i,s,a,n,r):t}(d,o,i<0?-r:r,l,n.minDate,n.maxDate),void 0!==d&&a.changeFocus(d).render()}function ge(e,t){return e.map(e=>S(e,t.format,t.locale)).join(t.dateDelimiter)}function ye(e,t,i=!1){const{config:s,dates:a,rangeSideIndex:n}=e;if(0===t.length)return i?[]:void 0;let r=t.reduce((e,t)=>{t=k(t,s.format,s.locale);return void 0===t||(!c(t=L(t,s.pickLevel,n),s.minDate,s.maxDate)||e.includes(t)||s.datesDisabled.includes(t)||!(0<s.pickLevel)&&s.daysOfWeekDisabled.includes(new Date(t).getDay())||e.push(t)),e},[]);return 0!==r.length?(s.multidate&&!i&&(r=r.reduce((e,t)=>(a.includes(t)||e.push(t),e),a.filter(e=>!r.includes(e)))),s.maxNumberOfDates&&r.length>s.maxNumberOfDates?r.slice(-1*s.maxNumberOfDates):r):void 0}function _e(e,t=3,i=!0){const{config:s,picker:a,inputField:n}=e;if(2&t){const e=a.active?s.pickLevel:s.startView;a.update().changeView(e).render(i)}1&t&&n&&(n.value=ge(e.dates,s))}function Ee(e,t,i){let{clear:s,render:a,autohide:n,revert:r}=i;void 0===a&&(a=!0),a?void 0===n&&(n=e.config.autohide):n=!1;const o=ye(e,t,s);(o||r)&&(o&&o.toString()!==e.dates.toString()?(e.dates=o,_e(e,a?3:1),ae(e,"changeDate")):_e(e,1),n&&e.hide())}class we{constructor(e,t={},i){(e.datepicker=this).element=e;const s=this.config=Object.assign({buttonClass:t.buttonClass&&String(t.buttonClass)||"button",container:null,defaultViewDate:m(),maxDate:void 0,minDate:void 0},G(q,this)),a=this.inline="INPUT"!==e.tagName;let n,r;if(a?s.container=e:(t.container&&(s.container=t.container instanceof HTMLElement?t.container:document.querySelector(t.container)),n=this.inputField=e,n.classList.add("datepicker-input")),i){const l=i.inputs.indexOf(n),t=i.datepickers;if(l<0||1<l||!Array.isArray(t))throw Error("Invalid rangepicker object.");t[l]=this,Object.defineProperty(this,"rangepicker",{get:()=>i}),Object.defineProperty(this,"rangeSideIndex",{get:()=>l})}this._options=t,Object.assign(s,G(t,this)),a?(r=d(e.dataset.date,s.dateDelimiter),delete e.dataset.date):r=d(n.value,s.dateDelimiter),this.dates=[];e=ye(this,r);e&&0<e.length&&(this.dates=e),n&&(n.value=ge(this.dates,s));const o=this.picker=new be(this);if(a)this.show();else{const l=function(e,t){const{element:i,picker:s}=e;if(s.active||O(i)){const a=s.element;P(t,e=>e===i||e===a)||oe(e)}}.bind(null,this);R(this,[[n,"keydown",function(e,t){var i=t.key;if("Tab"!==i){const s=e.picker,{id:a,isMinView:n}=s.currentView;if(s.active){if(e.editMode)return void("Enter"===i?e.exitEditMode({update:!0,autohide:e.config.autohide}):"Escape"===i&&s.hide());if("ArrowLeft"===i)if(t.ctrlKey||t.metaKey)ne(e,-1);else{if(t.shiftKey)return void e.enterEditMode();ve(e,t,-1,!1)}else if("ArrowRight"===i)if(t.ctrlKey||t.metaKey)ne(e,1);else{if(t.shiftKey)return void e.enterEditMode();ve(e,t,1,!1)}else if("ArrowUp"===i)if(t.ctrlKey||t.metaKey)re(e);else{if(t.shiftKey)return void e.enterEditMode();ve(e,t,-1,!0)}else if("ArrowDown"===i){if(t.shiftKey&&!t.ctrlKey&&!t.metaKey)return void e.enterEditMode();ve(e,t,1,!0)}else{if("Enter"!==i)return void("Escape"===i?s.hide():"Backspace"!==i&&"Delete"!==i&&(1!==i.length||t.ctrlKey||t.metaKey)||e.enterEditMode());if(n)return void e.setDate(s.viewDate);s.changeView(a-1).render()}}else{if("ArrowDown"!==i)return void("Enter"===i?e.update():"Escape"===i&&s.show());s.show()}t.preventDefault()}else oe(e)}.bind(null,this)],[n,"focus",function(e){e.config.showOnFocus&&!e._showing&&e.show()}.bind(null,this)],[n,"mousedown",function(e,t){const i=t.target;(e.picker.active||e.config.showOnClick)&&(i._active=O(i),i._clicking=setTimeout(()=>{delete i._active,delete i._clicking},2e3))}.bind(null,this)],[n,"click",function(e,t){const i=t.target;i._clicking&&(clearTimeout(i._clicking),delete i._clicking,i._active&&e.enterEditMode(),delete i._active,e.config.showOnClick&&e.show())}.bind(null,this)],[n,"paste",function(e,t){t.clipboardData.types.includes("text/plain")&&e.enterEditMode()}.bind(null,this)],[document,"mousedown",l],[document,"touchstart",l],[window,"resize",o.place.bind(o)]])}}static formatDate(e,t,i){return S(e,t,i&&H[i]||H.en)}static parseDate(e,t,i){return k(e,t,i&&H[i]||H.en)}static get locales(){return H}get active(){return!(!this.picker||!this.picker.active)}get pickerElement(){return this.picker?this.picker.element:void 0}setOptions(e){const t=this.picker,i=G(e,this);Object.assign(this._options,e),Object.assign(this.config,i),t.setOptions(i),_e(this,3)}show(){if(this.inputField){if(this.inputField.disabled)return;O(this.inputField)||this.config.disableTouchKeyboard||(this._showing=!0,this.inputField.focus(),delete this._showing)}this.picker.show()}hide(){this.inline||(this.picker.hide(),this.picker.update().changeView(this.config.startView).render())}destroy(){return this.hide(),V(this),this.picker.detach(),this.inline||this.inputField.classList.remove("datepicker-input"),delete this.element.datepicker,this}getDate(t){const e=t?e=>S(e,t,this.config.locale):e=>new Date(e);return this.config.multidate?this.dates.map(e):0<this.dates.length?e(this.dates[0]):void 0}setDate(...e){const t=[...e],i={},s=o(e);"object"!=typeof s||Array.isArray(s)||s instanceof Date||!s||Object.assign(i,t.pop()),Ee(this,Array.isArray(t[0])?t[0]:t,i)}update(e){this.inline||(e=Object.assign(e||{},{clear:!0,render:!0}),Ee(this,d(this.inputField.value,this.config.dateDelimiter),e))}refresh(e,t=!1){e&&"string"!=typeof e&&(t=e,e=void 0),_e(this,"picker"===e?2:"input"===e?1:3,!t)}enterEditMode(){this.inline||!this.picker.active||this.editMode||(this.editMode=!0,this.inputField.classList.add("in-edit"))}exitEditMode(e){!this.inline&&this.editMode&&(e=Object.assign({update:!1},e),delete this.editMode,this.inputField.classList.remove("in-edit"),e.update&&this.update(e))}}function Le(e){const t=Object.assign({},e);return delete t.inputs,delete t.allowOneSidedRange,delete t.maxNumberOfDates,t}function De(e,t,i,s){R(e,[[i,"changeDate",t]]),new we(i,s,e)}function ke(e,t){if(!e._updating){e._updating=!0;t=t.target;if(void 0!==t.datepicker){const i=e.datepickers,s={render:!1},a=e.inputs.indexOf(t),n=0===a?1:0,r=i[a].dates[0],o=i[n].dates[0];void 0!==r&&void 0!==o?0===a&&o<r?(i[0].setDate(o,s),i[1].setDate(r,s)):1===a&&r<o&&(i[0].setDate(r,s),i[1].setDate(o,s)):e.allowOneSidedRange||void 0===r&&void 0===o||(s.clear=!0,i[n].setDate(i[a].dates,s)),i[0].picker.update().render(),i[1].picker.update().render(),delete e._updating}}}window.Datepicker=we,window.DateRangePicker=class{constructor(e,t={}){const i=Array.isArray(t.inputs)?t.inputs:Array.from(e.querySelectorAll("input"));if(!(i.length<2)){(e.rangepicker=this).element=e,this.inputs=i.slice(0,2),this.allowOneSidedRange=!!t.allowOneSidedRange;const s=ke.bind(null,this),a=Le(t),n=[];Object.defineProperty(this,"datepickers",{get:()=>n}),De(this,s,this.inputs[0],a),De(this,s,this.inputs[1],a),Object.freeze(n),0<n[0].dates.length?ke(this,{target:this.inputs[0]}):0<n[1].dates.length&&ke(this,{target:this.inputs[1]})}}get dates(){return 2===this.datepickers.length?[this.datepickers[0].dates[0],this.datepickers[1].dates[0]]:void 0}setOptions(e){this.allowOneSidedRange=!!e.allowOneSidedRange;e=Le(e);this.datepickers[0].setOptions(e),this.datepickers[1].setOptions(e)}destroy(){this.datepickers[0].destroy(),this.datepickers[1].destroy(),V(this),delete this.element.rangepicker}getDates(t){const i=t?e=>S(e,t,this.datepickers[0].config.locale):e=>new Date(e);return this.dates.map(e=>void 0===e?e:i(e))}setDates(e,t){const[i,s]=this.datepickers,a=this.dates;this._updating=!0,i.setDate(e),s.setDate(t),delete this._updating,s.dates[0]!==a[1]?ke(this,{target:this.inputs[1]}):i.dates[0]!==a[0]&&ke(this,{target:this.inputs[0]})}}}(),Datepicker.locales.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],daysShort:["So","Mo","Di","Mi","Do","Fr","Sa"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",monthsTitle:"Monate",clear:"Löschen",weekStart:1,format:"dd.mm.yyyy"};"use strict";const MAIN_BLOCK="dual-listbox",CONTAINER_ELEMENT="dual-listbox__container",AVAILABLE_ELEMENT="dual-listbox__available",SELECTED_ELEMENT="dual-listbox__selected",TITLE_ELEMENT="dual-listbox__title",ITEM_ELEMENT="dual-listbox__item",BUTTONS_ELEMENT="dual-listbox__buttons",BUTTON_ELEMENT="dual-listbox__button",SEARCH_ELEMENT="dual-listbox__search",SELECTED_MODIFIER="dual-listbox__item--selected";class DualListbox{constructor(e,t={}){this.setDefaults(),this.selected=[],this.available=[],DualListbox.isDomElement(e)?this.select=e:this.select=document.querySelector(e),this._initOptions(t),this._initReusableElements(),this._splitOptions(this.select.options),void 0!==t.options&&this._splitOptions(t.options),this._buildDualListbox(this.select.parentNode),this._addActions(),this.redraw()}setDefaults(){this.addEvent=null,this.removeEvent=null,this.availableTitle="Available options",this.selectedTitle="Selected options",this.showAddButton=!0,this.addButtonText=window.OAP.labels.JSLABEL_DUALLIST_ADD||"add",this.showRemoveButton=!0,this.removeButtonText=window.OAP.labels.JSLABEL_DUALLIST_REMOVE||"remove",this.showAddAllButton=!0,this.addAllButtonText=window.OAP.labels.JSLABEL_DUALLIST_ADD_ALL||"add all",this.showRemoveAllButton=!0,this.removeAllButtonText=window.OAP.labels.JSLABEL_DUALLIST_REMOVE_ALL||"remove all",this.searchPlaceholder=window.OAP.labels.JSLABEL_DUALLIST_SEARCH||"search"}addEventListener(e,t){this.dualListbox.addEventListener(e,t)}addSelected(t){var e=this.available.indexOf(t);-1<e&&(this.available.splice(e,1),this.selected.push(t),this._selectOption(t.dataset.id),this.redraw(),setTimeout(()=>{let e=document.createEvent("HTMLEvents");e.initEvent("added",!1,!0),e.addedElement=t,this.dualListbox.dispatchEvent(e)},0))}redraw(){this.updateAvailableListbox(),this.updateSelectedListbox()}removeSelected(t){var e=this.selected.indexOf(t);-1<e&&(this.selected.splice(e,1),this.available.push(t),this._deselectOption(t.dataset.id),this.redraw(),setTimeout(()=>{let e=document.createEvent("HTMLEvents");e.initEvent("removed",!1,!0),e.removedElement=t,this.dualListbox.dispatchEvent(e)},0)),0===this.selected.length&&(this.select.value="")}searchLists(e,t){var i=t.querySelectorAll(`.${ITEM_ELEMENT}`),s=e.toLowerCase();for(let t=0;t<i.length;t++){let e=i[t];-1===e.textContent.toLowerCase().indexOf(s)?e.style.display="none":e.style.display="list-item"}}updateAvailableListbox(){this._updateListbox(this.availableList,this.available)}updateSelectedListbox(){this._updateListbox(this.selectedList,this.selected)}_actionAllSelected(e){e.preventDefault();let t=this.available.filter(e=>"none"!==e.style.display);t.forEach(e=>this.addSelected(e))}_updateListbox(t,i){for(;t.firstChild;)t.removeChild(t.firstChild);for(let e=0;e<i.length;e++){var s=i[e];t.appendChild(s)}}_actionItemSelected(e){e.preventDefault();e=this.dualListbox.querySelector(`.${SELECTED_MODIFIER}`);e&&this.addSelected(e)}_actionAllDeselected(e){e.preventDefault();let t=this.selected.filter(e=>"none"!==e.style.display);t.forEach(e=>this.removeSelected(e))}_actionItemDeselected(e){e.preventDefault();e=this.dualListbox.querySelector(`.${SELECTED_MODIFIER}`);e&&this.removeSelected(e)}_actionItemDoubleClick(e,t=null){t&&(t.preventDefault(),t.stopPropagation()),-1<this.selected.indexOf(e)?this.removeSelected(e):this.addSelected(e)}_actionItemClick(i,e,t=null){t&&t.preventDefault();var s=e.querySelectorAll(`.${ITEM_ELEMENT}`);for(let t=0;t<s.length;t++){let e=s[t];e!==i&&e.classList.remove(SELECTED_MODIFIER)}i.classList.contains(SELECTED_MODIFIER)?i.classList.remove(SELECTED_MODIFIER):i.classList.add(SELECTED_MODIFIER)}_addActions(){this._addButtonActions(),this._addSearchActions()}_addButtonActions(){this.add_all_button.addEventListener("click",e=>this._actionAllSelected(e)),this.add_button.addEventListener("click",e=>this._actionItemSelected(e)),this.remove_button.addEventListener("click",e=>this._actionItemDeselected(e)),this.remove_all_button.addEventListener("click",e=>this._actionAllDeselected(e))}_addClickActions(t){return t.addEventListener("dblclick",e=>this._actionItemDoubleClick(t,e)),t.addEventListener("click",e=>this._actionItemClick(t,this.dualListbox,e)),t}_addSearchActions(){this.search_left.addEventListener("change",e=>this.searchLists(e.target.value,this.availableList)),this.search_left.addEventListener("keyup",e=>this.searchLists(e.target.value,this.availableList)),this.search_right.addEventListener("change",e=>this.searchLists(e.target.value,this.selectedList)),this.search_right.addEventListener("keyup",e=>this.searchLists(e.target.value,this.selectedList))}_buildDualListbox(e){this.select.style.display="none",this.dualListBoxContainer.appendChild(this._createList(this.search_left,this.availableListTitle,this.availableList)),this.dualListBoxContainer.appendChild(this.buttons),this.dualListBoxContainer.appendChild(this._createList(this.search_right,this.selectedListTitle,this.selectedList)),this.dualListbox.appendChild(this.dualListBoxContainer),e.insertBefore(this.dualListbox,this.select)}_createList(e,t,i){let s=document.createElement("div");return s.appendChild(e),s.appendChild(t),s.appendChild(i),s}_createButtons(){this.buttons=document.createElement("div"),this.buttons.classList.add(BUTTONS_ELEMENT),this.add_all_button=document.createElement("button"),this.add_all_button.innerHTML=this.addAllButtonText,this.add_button=document.createElement("button"),this.add_button.innerHTML=this.addButtonText,this.remove_button=document.createElement("button"),this.remove_button.innerHTML=this.removeButtonText,this.remove_all_button=document.createElement("button"),this.remove_all_button.innerHTML=this.removeAllButtonText;var e,t={showAddAllButton:this.add_all_button,showAddButton:this.add_button,showRemoveButton:this.remove_button,showRemoveAllButton:this.remove_all_button};for(e in t)if(e){var i=this[e];const s=t[e];s.setAttribute("type","button"),s.classList.add(BUTTON_ELEMENT),i&&this.buttons.appendChild(s)}}_createListItem(e){let t=document.createElement("li");return t.classList.add(ITEM_ELEMENT),t.innerHTML=e.text.replace(/\|/g,"<br>"),t.dataset.id=e.value,this._addClickActions(t),t}_createSearchLeft(){this.search_left=document.createElement("input"),this.search_left.classList.add(SEARCH_ELEMENT),this.search_left.placeholder=this.searchPlaceholder}_createSearchRight(){this.search_right=document.createElement("input"),this.search_right.classList.add(SEARCH_ELEMENT),this.search_right.placeholder=this.searchPlaceholder}_deselectOption(i){var s=this.select.options;for(let t=0;t<s.length;t++){let e=s[t];e.value===i&&(e.selected=!1,e.removeAttribute("selected"))}this.removeEvent&&this.removeEvent(i)}_initOptions(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}_initReusableElements(){this.dualListbox=document.createElement("div"),this.dualListbox.classList.add(MAIN_BLOCK),this.select.id&&this.dualListbox.classList.add(this.select.id),this.dualListBoxContainer=document.createElement("div"),this.dualListBoxContainer.classList.add(CONTAINER_ELEMENT),this.availableList=document.createElement("ul"),this.availableList.classList.add(AVAILABLE_ELEMENT),this.selectedList=document.createElement("ul"),this.selectedList.classList.add(SELECTED_ELEMENT),this.availableListTitle=document.createElement("div"),this.availableListTitle.classList.add(TITLE_ELEMENT),this.availableListTitle.innerText=this.availableTitle,this.selectedListTitle=document.createElement("div"),this.selectedListTitle.classList.add(TITLE_ELEMENT),this.selectedListTitle.innerText=this.selectedTitle,this._createButtons(),this._createSearchLeft(),this._createSearchRight()}_selectOption(i){var s=this.select.options;for(let t=0;t<s.length;t++){let e=s[t];e.value===i&&(e.selected=!0,e.setAttribute("selected",""))}this.addEvent&&this.addEvent(i)}_splitOptions(t){for(let e=0;e<t.length;e++){var i=t[e];DualListbox.isDomElement(i)?this._addOption({text:i.innerHTML,value:i.value,selected:i.attributes.selected}):this._addOption(i)}}_addOption(e){var t=this._createListItem(e);(e.selected?this.selected:this.available).push(t)}static isDomElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}}!function(u,i){i.utils=i.utils||{},i.utils.errorList=function(){function t(n,e){const t=n.querySelectorAll('[aria-invalid="true"]');let i=n.querySelector('[role="alert"]'),s=!!i&&i.dataset.completeMessage,r="",a="";t.length<1&&!s||(i||(i=o.createElement("div"),i.setAttribute("role","alert"),n.insertBefore(i,n.firstChild)),e||""===i.innerHTML?(t.forEach(function(s){if(s.id&&""!==s.id){let t=n.querySelector("label[for="+s.id+"]"),i=s.id+"--item",e="";if(t&&t.classList.contains(l.formCheckableLabel)&&(i=t.dataset.legend,t=n.querySelector("legend#"+t.dataset.legend)),!t){let e=s.closest("."+l.formGroup);e&&(t=e.querySelector("label"),i=e.id)}var a;t||(a=s.closest("."+l.formTableCell))&&(e=a.dataset.errorlabel,i=s.id),t&&""===e&&(s=t.textContent.split("*"),e=s[0]),e&&(r+='<li class="'+l.errorListItem+'"><a href="#'+i+'" class="'+l.errorListLink+'">'+e+"</a></li>")}}),a='<ul class="'+l.errorList+'">'+r+"</ul>"):(a=i.innerHTML,c(i)),u.setTimeout(function(){s?i.innerHTML="<div>"+a+"</div>":i.innerHTML='<div class="'+l.errorListBox+'"><p class="'+l.errorListMessage+'"><strong>'+d.JSMSG_ERROR_LABEL+":</strong> "+d.JSMSG_ERROR_MESSAGE+"</p>"+a+"</div>",i.id&&(u.location.hash="#"+i.id)},150))}const o=u.document,l={error:"form__error",errorListBox:"form__error-list-box",errorList:"form__error-list",errorListItem:"form__error-list-item",errorListLink:"form__error-list-link",errorListMessage:"form__error-list-text",alertMessage:"form__alert",formGroup:"form__group",formGroupError:"form__group--error",formTableCell:"form__table-cell",formCheckableLabel:"form__checkable-label"},e={form:".form--proposal"},d=i.labels||{},c=function(e){const t=e.querySelectorAll("."+l.errorListLink);t.forEach(function(e){let t=o.querySelector(e.hash),i;t&&(t.classList.add(l.error),t.setAttribute("aria-invalid","true"),i=t.closest("."+l.formGroup),i&&i.classList.add(l.formGroupError))})};return{show:function(){o.querySelectorAll(e.form).forEach(function(e){t(e)})},update:function(e){t(e,!0)}}}()}(this,this.OAP||{}),function(h,e){e.utils=e.utils||{},e.utils.modal=function(){const a=h.document,e={modal:"oap-modal",modalContent:"oap-modal-content",modalSubmit:"oap-modal-submit",modalCancel:"oap-modal-cancel",loader:"oap-loader"},n={warningAccepted:"warningAccepted"};let r,o,l,d,c,u;return o=a.getElementById(e.modal),l=a.getElementById(e.modalContent),d=a.getElementById(e.modalSubmit),c=a.getElementById(e.modalCancel),u=a.getElementById(e.loader),o&&a.body.appendChild(o),u&&a.body.appendChild(u),{show:function(e,t,i,s){o&&u&&(r&&r.destroy(),r=new h.A11yDialog(o),l&&(l.innerHTML=e),c&&(c.innerHTML=i),d&&(d.innerHTML=t),d&&(d.addEventListener("click",function(){s.dataset[n.warningAccepted]=1,r.hide(),a.activeElement.click(),u.style.display="flex"}),d.removeAttribute("disabled")),r.show())}}}()}(this,this.OAP||{}),function(e){e.utils=e.utils||{},e.utils.formatNumber=function(){const s={maximumFractionDigits:2,minimumFractionDigits:0},a={maximumFractionDigits:2,minimumFractionDigits:2};return{format:function(e){var t=Math.floor(e),i=e-t;return e=e&&!isNaN(t)?(0<i?new Intl.NumberFormat("de-DE",a):new Intl.NumberFormat("de-DE",s)).format(e):e}}}()}(this.OAP||{}),function(e,t){const s=e.document,i={countableAreas:"textarea[data-oap-maxlength]"},a={counterBox:"counter",countCurrent:"counter-current",maxedOut:"js-counter-max"},n={maxlength:"oapMaxlength"};const r=(t.labels||{}).JSMSG_CHARACTERS_REMAINING,o=function(e){let t=s.createElement("div");var i;return e.id&&""!==e.id&&(i=e.id+"-counter",t.id=i,e.setAttribute("aria-describedby",i)),t.innerHTML=r.replace("%s",'<span class="'+a.countCurrent+'"></span>'),t.classList.add(a.counterBox),e.parentNode.appendChild(t),{wrapper:t,countCurrent:t.querySelector("."+a.countCurrent)}},l=function(e,t){var i=[...e.value.replace(/[\n\r\t]/g,"")].length;t.countCurrent.innerText=e.dataset[n.maxlength]-i,i>=e.dataset[n.maxlength]?t.wrapper.classList.add(a.maxedOut):t.wrapper.classList.remove(a.maxedOut)};s.querySelectorAll(i.countableAreas).forEach(function(e){!function(e){const t=o(e);e.addEventListener("keyup",function(){l(e,t)}),l(e,t)}(e)})}(this,this.OAP||{}),function(e){const t=e.document,i={submitAccepted:".submit_accepted",submitButton:"#submit-proposal"};let s=!1,a=!1;a=t.querySelectorAll(i.submitAccepted),a.forEach(function(e){e.addEventListener("change",function(){s=!0,a.forEach(function(e){s=s&&e.checked}),t.querySelector(i.submitButton).disabled=!s})})}(this),function(e,u){const h=e.document,r={validatableFormFields:"[data-oap-validat]",serverErrorList:"[data-oap-servererror]",enableDisabledElements:"[type=checkbox][disabled], [type=radiobutton][disabled], select[disabled]"},f={pseudoFileInput:"form__upload-value",errorMessage:"error-message",errorMessageLabel:"form__label-question--error",errorMessageItem:"error-message__item"},p={validate:"oapValidat",type:"oapType",maxlength:"oapMaxlength",minvalue:"oapMinvalue",maxvalue:"oapMaxvalue",warningAccepted:"warningAccepted",showAlwaysModal:"oapShowmodal",modalText:"oapModaltext",modalSubmit:"oapModalsubmit",modalCancel:"oapModalcancel",serverError:"oapServererror",uploadresult:"oapUploadvalidation"},m=u.labels||{},t="oap-proposal-",o=",",a='<svg class="form__icon form__icon--error" width="20" height="22" focusable="false" aria-hidden="true"> <use xlink:href="/_assets/d867b284b013b280ddc9dda86ad2fa21/Icons/sprite.svg#icon-error" x="0" y="0"/> </svg>';let l=!1,i=0,d=[],c=[],b={};function v(e){return!!e&&(e=e.toString().replace(/^(.{2})\.(.{2})\.(.{4})$/,"$3-$2-$1"),Date.parse(e))}function g(e,t,i,s){s&&Object.entries(s).forEach(function(e){t=t.replace(e[0],e[1])}),e.innerHTML+='<span class="'+f.errorMessageItem+'">'+a+t+"</span>",i.setAttribute("aria-invalid","true"),i.labelElement&&i.labelElement.classList.add(f.errorMessageLabel)}const y=function(o,l,e,d){let c={critical:!0,relaxed:!0};return o.removeAttribute("aria-invalid"),o.labelElement&&o.labelElement.classList.remove(f.errorMessageLabel),d.innerHTML="",e.forEach(function(e){"file"!==o.type&&"select-multiple"!==o.type&&(o.value=o.value.toString().trim());var t=o.value&&""!==o.value,i=!isNaN(Number(o.value));switch(e){case"VALIDATOR_MANDATORY":{let t=!0;switch(o.type){case"checkbox":case"radio":var s=h.querySelector("#"+o.id).closest(".form__group").querySelector(":scope legend").id;if(void 0===b[s]){const r=h.querySelector("#"+o.id).closest(".form__checkable-group").querySelectorAll("input.form__checkable");t=!1,r.forEach(function(e){e.checked&&(t=!0)}),b[s]=t}break;case"hidden":o.classList.contains(f.pseudoFileInput)&&(o.value&&""!==o.value||(t=!1));break;case"file":t=!0;break;default:o.value&&""!==o.value||(t=!1)}t||(g(d,m.JSMSG_MANDATORY,o),c.relaxed=!1);break}case"VALIDATOR_MAXCHAR":o.dataset[p.maxlength]-[...o.value.replace(/[\n\r\t]/g,"")].length<0&&(g(d,m.JSMSG_MAX_LEN_EXCEEDED,o),c.critical=!1);break;case"VALIDATOR_INTEGER":t&&!Number.isInteger(Number(o.value.toString().replace(/\./g,"").replace(/,/g,".")))&&(g(d,m.JSMSG_NO_INTEGER,o),c.critical=!1);break;case"VALIDATOR_FLOAT":t&&!Number.isFinite(Number(o.value.toString().replace(/\./g,"").replace(/,/g,".")))&&(g(d,m.JSMSG_NO_FLOAT,o),c.critical=!1);break;case"VALIDATOR_MINVALUE":if(!t)break;switch(l){case"TYPE_DATE1":case"TYPE_DATE2":v(o.value)<v(o.dataset[p.minvalue])&&(c.critical=!1);break;case"TYPE_UPLOAD":o.classList.contains(f.pseudoFileInput)&&""!==o.value&&o.value.split(",").length<o.dataset[p.minvalue]&&(c.critical=!0,g(d,m.JSMSG_MIN_VALUE,o,{"%d":o.dataset[p.minvalue]}));break;default:var a=o.value.toString().replace(/\./g,"").replace(/,/g,".");(!i||Number(a)<o.dataset[p.minvalue])&&(c.critical=!1)}if(!c.critical){let e=o.dataset[p.minvalue];u.utils&&u.utils.formatNumber&&(e=u.utils.formatNumber.format(o.dataset[p.minvalue])),g(d,m.JSMSG_MIN_VALUE,o,{"%d":e})}break;case"VALIDATOR_MAXVALUE":switch(l){case"TYPE_DATE1":case"TYPE_DATE2":var n=v(o.value);v(o.dataset[p.maxvalue])<n&&(c.critical=!1);break;case"TYPE_UPLOAD":o.classList.contains(f.pseudoFileInput)&&""!==o.value&&o.value.split(",").length>o.dataset[p.maxvalue]&&(c.critical=!1);break;default:n=o.value.toString().replace(/\./g,"").replace(/,/g,".");(!i||Number(n)>o.dataset[p.maxvalue])&&(c.critical=!1)}if(!c.critical){let e=o.dataset[p.maxvalue];u.utils&&u.utils.formatNumber&&(e=u.utils.formatNumber.format(e)),g(d,m.JSMSG_MAX_VALUE,o,{"%d":e})}break;case"VALIDATOR_EMAIL":t&&!/^\S+@\S+\.\S+$/.test(o.value)&&(g(d,m.JSMSG_INVALID_EMAIL,o),c.critical=!1);break;case"VALIDATOR_PHONE":t&&!/^[0-9\s()+-]*$/.test(o.value)&&(g(d,m.JSMSG_INVALID_PHONE,o),c.critical=!1);break;case"VALIDATOR_FILE":if("file"!==o.type){let e=o.dataset[p.uploadresult];e.includes("size")&&(g(d,m.JSMSG_UPLOAD_ERROR_FILE_SIZE_SIMPLE,o),c.critical=!1),e.includes("max")&&(g(d,m.JSMSG_UPLOAD_MAX_FILES_REACHED,o),c.critical=!1),e.includes("min")&&(g(d,m.JSMSG_UPLOAD_MIN_FILES_REACHED,o),c.critical=!1)}}}),c},_=function(e,t){let i=h.createElement("div");var s,a;return i.classList.add(f.errorMessage),t.id&&""!==t.id&&(s=t.getAttribute("aria-describedby"),a=t.id+"-error",i.id=a,t.setAttribute("aria-describedby",(s?s+" ":"")+a)),e.appendChild(i),i},E=function(e){return e.id||(i+=1,e.id=t+i,t+i)};var s;(s=h.querySelector(r.serverErrorList))&&(l=s.dataset[p.serverError],h.querySelectorAll(r.validatableFormFields).forEach(function(e){!function(e){const t=e.dataset[p.type];var i=e.dataset[p.validate].split(o);const s=[...new Set(i)];let a=e.closest("label")||e.parentNode;"TYPE_CHECKBOX"!==t&&"TYPE_RADIOBUTTON"!==t||(a=e.closest(".form__checkable-group"));const n=_(a,e);i=e.closest("form");i&&c.push(E(i)),e.labelElement=h.querySelector('[for="'+e.id+'"]'),"TYPE_CHECKBOX"!==t&&"TYPE_RADIOBUTTON"!==t||(e.labelElement=h.querySelector("#"+e.labelElement.dataset.legend)),e.addEventListener("blur",function(){b={},y(e,t,s,n)}),"0"!==l&&y(e,t,s,n),d.push({formField:e,validators:s,messageBox:n,formId:i.id,type:t})}(e)}),u.utils&&u.utils.errorList&&u.utils.errorList.show(),h.querySelectorAll("form").forEach(function(e){var n;c.includes(e.id)&&(n=e).addEventListener("submit",function(e){let t={critical:!0,relaxed:!0};var i,s,a;d.forEach(function(e){e.formId&&((e=y(e.formField,e.type,e.validators,e.messageBox)).critical||(t.critical=!1),e.relaxed||(t.relaxed=!1))}),t.critical?(t.relaxed||n.dataset[p.warningAccepted])&&!n.dataset[p.showAlwaysModal]||(e.preventDefault(),u.utils&&u.utils.modal&&(i=m[e.submitter.dataset[p.modalText]],s=m[e.submitter.dataset[p.modalSubmit]],a=m[e.submitter.dataset[p.modalCancel]],u.utils.modal.show(i,s,a,n))):(e.preventDefault(),u.utils&&u.utils.errorList&&u.utils.errorList.update(n)),h.querySelectorAll(r.enableDisabledElements).forEach(function(e){e.disabled=0})})}))}(this,this.OAP||{}),function(e,a){const t=e.document,n=a.labels||{},i={modalLinks:".modal__link"},r={modalText:"oapModaltext",modalSubmit:"oapModalsubmit",modalCancel:"oapModalcancel",warningAccepted:"warningAccepted"};t.querySelectorAll(i.modalLinks).forEach(function(s){s.addEventListener("click",function(e){var t,i;s.dataset[r.warningAccepted]||(e.preventDefault(),a.utils&&a.utils.modal&&(t=n[s.dataset[r.modalText]],i=n[s.dataset[r.modalSubmit]],e=n[s.dataset[r.modalCancel]],a.utils.modal.show(t,i,e,s)))})})}(this,this.OAP||{}),function(e){const t=e.document,a={dateFormFields:"[data-oap-datepicker]",dateRangeFields:"[data-oap-daterangepicker]",datePickerIcon:".form__icon--datepicker"},n={datePicker:"oapDatepicker",dateRangePicker:"oapDaterangepicker"};t.querySelectorAll(a.dateFormFields).forEach(function(e){var t=e.dataset[n.datePicker],t=JSON.parse(t);let i=new Datepicker(e,t),s=e.parentElement.querySelector(a.datePickerIcon);s&&s.addEventListener("click",function(){i.show()})}),t.querySelectorAll(a.dateRangeFields).forEach(function(e){var t=e.dataset[n.dateRangePicker],t=JSON.parse(t);let i=new DateRangePicker(e,t);i.datepickers.forEach(function(e){let t=e.element.parentElement.querySelector(a.datePickerIcon);t&&t.addEventListener("click",function(){e.show()})})})}(this),function(e){function t(e){var t=e.select.dataset[a.maxvalue];e.select.querySelectorAll("[selected]").length>=t?(e.add_button.disabled=!0,e.availableList.classList.add(n.disabled)):(e.add_button.disabled=!1,e.availableList.classList.remove(n.disabled))}const i=e.document,s={duallistboxFields:"[data-oap-duallistbox]"},a={dualListBox:"oapDuallistbox",maxvalue:"oapMaxvalue"},n={removedField:"dual-listbox__removed",disabled:"js-disabled"},r=function(e){e.addEventListener("added",function(){t(e)}),e.addEventListener("removed",function(){t(e)}),t(e)};i.querySelectorAll(s.duallistboxFields).forEach(function(e){!function(e){var t=e.dataset[a.dualListBox],t=JSON.parse(t);let i=new DualListbox(e,t);i.search_left.setAttribute("type","text"),i.search_right.setAttribute("type","text"),i.search_right.classList.add(n.removedField),i.add_all_button.remove(),i.remove_all_button.remove(),e.disabled&&(i.add_button.disabled=!0,i.remove_button.disabled=!0,i.availableList.classList.add(n.disabled),i.selectedList.classList.add(n.disabled)),e.dataset[a.maxvalue]&&r(i)}(e)})}(this),function(e,t){function E(e,t=0){if(0===e)return"0 Bytes";var i=t<0?0:t,t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(i))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}const w=e.document,L=t.labels||{},D={base:"/index.php?",taskInfo:"oap-ajax-task=info",taskUpload:"oap-ajax-task=upload"},k={removeItemButton:"form__upload-btn-remove-file",downloadItemButton:"form__upload-btn-download-file"},S={uploadElement:"[data-oap-upload]",addButton:".form__add-file-button",uploadButton:".form__upload-file-button",clearStageButton:".form__upload-file-clear-button",removeItemButton:"."+k.removeItemButton,uploadList:".form__upload-list",uploadValue:".form__upload-value",fileList:".form__upload-fileslist",uploadMsg:".form__upload-msgbox",preUpload:".form__pre-upload",fileElement:'[type="file"]',form:'[name="proposal"]',fileListItem:".form__upload-filesitem",fileListStaged:".form__upload-staged",fileListStagedLabel:".form__upload-staged-label",errorList:".error-message"},x={upload:"oapUpload",savedFiles:"oapSavedfiles",propertyKey:"oapPropertykey",proposal:"oapProposal",uploadResult:"oapUploadvalidation"},A={listStart:'<ul class="form__upload-fileslist">',listEnd:"</ul>",listItemStart:'<li class="form__upload-filesitem">',listItemEnd:"</li>",messageOkStart:'<span class="form__upload-message form__upload-message--ok">',messageKoStart:'<span class="form__upload-message form__upload-message--error">',messageEnd:"</span>",listBtnDelete:'<svg class="form__icon form__icon--delete" width="18" height="18" focusable="false" aria-hidden="true"><use xlink:href="/typo3conf/ext/open_oap/Resources/Public/Icons/sprite.svg#icon-delete" x="0" y="0"></use></svg>',listBtnDownload:'<svg class="form__icon form__icon--download" width="18" height="18" focusable="false" aria-hidden="true"><use xlink:href="/typo3conf/ext/open_oap/Resources/Public/Icons/sprite.svg#icon-download" x="0" y="0"></use></svg>',errorSVG:'<svg class="form__icon form__icon--error" width="18" height="18" focusable="false" aria-hidden="true"><use xlink:href="/typo3conf/ext/open_oap/Resources/Public/Icons/sprite.svg#icon-error" x="0" y="0"></use></svg>',stagedFile:'<svg class="form__icon form__icon--uploaded" width="18" height="18" focusable="false" aria-hidden="true"><use xlink:href="/typo3conf/ext/open_oap/Resources/Public/Icons/sprite.svg#icon-file-uploaded" x="0" y="0"></use></svg>'};w.querySelectorAll(S.uploadElement).forEach(function(n){var e=n.dataset[x.upload];const r=parseInt(JSON.parse(e).maxFiles),a=parseInt(JSON.parse(e).maxSize),o=n.querySelector(S.fileElement),t=n.querySelector(S.uploadList),i=n.querySelector(S.errorList),l=n.querySelector(S.preUpload),d=n.querySelector(S.uploadMsg),c=n.querySelector(S.fileListStaged),u=n.querySelector(S.fileListStagedLabel),h=n.querySelector(S.uploadValue),f=n.querySelector(S.addButton),p=n.querySelector(S.uploadButton);let m=new FormData,b=[];function v(t){b.length=0;let i=h.value.split(",");for(let e=0;e<i.length;e++)i[e]===t.value&&(i.splice(e,1),e-=1);h.value=i.join(","),i.length<r&&(f.style.display="block"),t.closest(S.fileListItem).remove(),b.push({text:A.messageOkStart+L.JSMSG_UPLOAD_FILE_REMOVED+A.messageEnd,error:0}),_()}function g(){o.value="",l.style.display="none",t&&(t.innerHTML=""),b.length=0,i&&(i.innerHTML=""),h.removeAttribute("aria-invalid"),h.dataset[x.uploadResult]="",y(),_()}const y=function(){var e=function(e){let t=e.value.split(",").length;return""===e.value&&(t=0),t}(h);f.hasAttribute("disabled")&&f.removeAttribute("disabled"),o.files.length+e>r&&(h.dataset[x.uploadResult]="max",h.setAttribute("aria-invalid","true"),b.push({text:A.messageKoStart+L.JSMSG_UPLOAD_ERROR_TOO_MANY_FILES+A.messageEnd,error:1})),o.files.length+e>r&&f.setAttribute("disabled","disabled")},_=function(){if(d.innerHTML="",p.hasAttribute("disabled")&&p.removeAttribute("disabled"),0<b.length){let t="<ul>";for(let e=0;e<b.length;e++)t+="<li>"+b[e].text+"</li>",1!==b[e].error||p.hasAttribute("disabled")||p.setAttribute("disabled","disabled");t+="</ul>",d.innerHTML=t,b.length=0}};n.querySelectorAll(S.removeItemButton).forEach(function(e){e.addEventListener("click",function(){v(e,h),y()})}),n.querySelector(S.clearStageButton).addEventListener("click",function(){g()}),f.addEventListener("click",function(){o.click()},!1),o.addEventListener("change",function(){let i=A.listStart,s="";d.innerHTML="";for(let e=0,t=o.files;e<o.files.length;e++)m.append("file-"+[...m.keys()].length,t[e],t[e].name),t[e].size>a&&(s=A.messageKoStart+A.errorSVG+A.messageEnd,o.dataset[x.uploadResult]="size",h.hasAttribute("aria-invalid")||h.setAttribute("aria-invalid","true"),b.push({text:A.messageKoStart+A.errorSVG+" "+L.JSMSG_UPLOAD_ERROR_FILE_SIZE.replace("%1",E(a))+A.messageEnd,error:1}),p.setAttribute("disabled","disabled")),i+=A.listItemStart+s+" "+t[e].name+" ("+E(t[e].size)+") "+A.listItemEnd;i+=A.listEnd,t.innerHTML=i,l.style.display="block",y(),_()}),p.addEventListener("click",function(){var i=o.files.length;if(d.innerHTML="",0<i){p.hasAttribute("disabled")||p.setAttribute("disabled","disabled");var s=n.closest(S.form).dataset[x.proposal],a=n.dataset[x.propertyKey];let t=new FormData;for(let e=0;e<i;e++)t.append("files[]",o.files[e]);let e=new XMLHttpRequest;a=D.base+D.taskUpload+"&proposal="+s+"&answer="+a;e.open("POST",a,!0),e.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var s=JSON.parse(this.responseText);g();for(let t=0,i=s.data.files;t<s.data.files.length;t++){let e=w.createElement("li");e.setAttribute("class","form__upload-filesitem");var a=function(e,t,i){let s=w.createElement("button");return s.setAttribute("value",e[t].uid),s.setAttribute("class",k.removeItemButton),s.setAttribute("type","button"),s.setAttribute("title","Remove file"),s.innerHTML=A.listBtnDelete,s.addEventListener("click",function(){i(s,s.value)}),s}(i,t,v),n=function(e,t){let i=w.createElement("a");return i.setAttribute("href",e[t].url),i.setAttribute("target","_blank"),i.setAttribute("class",k.downloadItemButton),i.innerHTML=A.listBtnDownload,i}(i,t);e.innerHTML=A.stagedFile+" "+i[t].name+" ("+E(i[t].size)+")",e.append(a),e.append(n),c.style.display="block",u.style.display="block",c.appendChild(e)}b.push({text:A.messageOkStart+L.JSMSG_UPLOAD_UPLOADED+A.messageEnd,error:0});let e=h.value.split(",");""===h.value&&(e.length=0);let t=[...e,...s.data.ids];t.length>=r&&(h.setAttribute("aria-invalid","false"),f.style.display="none",b.push({text:L.JSMSG_UPLOAD_MAX_FILES_REACHED,error:0}));var i=t.join(",");h.setAttribute("value",i),_()}p.hasAttribute("disabled")&&p.removeAttribute("disabled")},e.send(t)}}),y()})}(this,this.OAP||{}),function(e){const t=e.document,a={checkableGroupWithAdditionalValue:".form__checkable-group--additionalvalue",checkableItem:".form__checkable-label input.form__checkable",additionalInput:".form__textfield"};t.querySelectorAll(a.checkableGroupWithAdditionalValue).forEach(function(e){let t=e.querySelector(a.additionalInput),i=e.querySelectorAll(a.checkableItem),s=i[i.length-1];t.disabled=!s.checked,"radio"===s.type&&i.forEach(function(e){e.addEventListener("change",function(){t.disabled=!s.checked})}),"checkbox"===s.type&&s.addEventListener("change",function(){t.disabled=!s.checked})})}(this),function(e,t){const i=e.document,s={formattingField:".form__textfield--number"};i.querySelectorAll(s.formattingField).forEach(function(e){e.addEventListener("blur",function(){var e;""!==this.value.toString().trim()&&t.utils&&t.utils.formatNumber&&(e=this.value.toString().replace(/\./g,"").replace(/,/g,"."),this.value=t.utils.formatNumber.format(e))})})}(this,this.OAP||{});
